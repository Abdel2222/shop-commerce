!function(e){function o(s){if(t[s])return t[s].exports;var i=t[s]={i:s,l:!1,exports:{}};return e[s].call(i.exports,i,i.exports,o),i.l=!0,i.exports}var t={};o.m=e,o.c=t,o.d=function(e,t,s){o.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:s})},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,o){return Object.prototype.hasOwnProperty.call(e,o)},o.p="",o(o.s=2)}([function(e,o){e.exports={debug:!1,defaultLang:"fr",target:["_blank","_self","_parent","_top","framename"]}},function(e,o){function t(e,o,t){var s=new window.XMLHttpRequest;return s.open(e.method||"GET",e.url),e.headers&&Object.keys(e.headers).forEach(function(o){s.setRequestHeader(o,e.headers[o])}),s.onload=function(){s.status>=200&&s.status<300?o(s.response):t(s.statusText)},s.onerror=function(){t(s.statusText)},s.send(e.body),s}function s(e,o,s){t({url:e},o,s)}e.exports={get:s}},function(e,o,t){t(3),wgs={searchwidget:{CONSTANT:t(0),RecommendationPlugin:t(4)}}},function(e,o){window.Element&&!Element.prototype.closest&&(Element.prototype.closest=function(e){var o,t=(this.document||this.ownerDocument).querySelectorAll(e),s=this;do{for(o=t.length;--o>=0&&t.item(o)!==s;);}while(o<0&&(s=s.parentElement));return s}),Array.isArray||(Array.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)})},function(e,o,t){function s(e,o){if(this.manager=null,this.ui=null,o.container=e,this.config=new i(o),window.woosmapRecommendation=new l(this.config.options.woosmap),this.mapsLoader=new n({clientId:this.config.options.google.clientId,channelId:this.config.options.google.channel,key:this.config.options.google.key,librariesToLoad:["places"],region:this.config.options.google.region,language:this.config.options.google.language}),this.container=document.querySelector(e),this.callbackInitialRecommendedStore=this.config.options.callbackInitialRecommendedStore instanceof Function?this.config.options.callbackInitialRecommendedStore:null,this.callbackUserSelectedStore=this.config.options.callbackUserSelectedStore instanceof Function?this.config.options.callbackUserSelectedStore:null,this.callbackOnSuccessHTML5Location=this.config.options.callbackOnSuccessHTML5Location instanceof Function?this.config.options.callbackOnSuccessHTML5Location:null,this.callbackOnErrorHTML5Location=this.config.options.callbackOnErrorHTML5Location instanceof Function?this.config.options.callbackOnErrorHTML5Location:null,this.callbackDOMWidgetReady=this.config.options.callbackDOMWidgetReady instanceof Function?this.config.options.callbackDOMWidgetReady:null,null===this.container)throw new Error("querySelector for "+e+" returned null.");this.mapsLoader.load(function(){this.ui=new r(this.container,this,this.config),this.manager=new a(this,this.config),!0===this.config.options.userAllowedReco?this.allowUserReco():this.manager.initialRecommendation(),this.callbackDOMWidgetReady instanceof Function&&this.callbackDOMWidgetReady()}.bind(this))}var i=t(5),n=t(6),r=t(7),a=t(12),l=t(14);s.prototype.allowUserReco=function(){woosmapRecommendation.setProjectKey(this.config.options.woosmapKey),woosmapRecommendation.getConsent(function(e){!1===e&&woosmapRecommendation.optIn(),this.config.options.userAllowedReco=!0,this.manager.initialRecommendation()}.bind(this))},s.prototype.setSelectedStoreId=function(e,o,t){var s=this;this.manager.selectStoreFromStoreId(e,function(e){o(e),!0===s.config.options.userAllowedReco&&"object"==typeof woosmapRecommendation&&woosmapRecommendation.sendUserConsultedPOI({lat:e.geometry.coordinates[1],lng:e.geometry.coordinates[0],id:e.properties.store_id})},t)},e.exports=s},function(e,o,t){function s(e){return e&&"object"==typeof e&&!Array.isArray(e)}function i(e,o){if(s(e)&&s(o))for(var t in o)o.hasOwnProperty(t)&&(s(o[t])?(e[t]||(e[t]={}),i(e[t],o[t])):e[t]=o[t]);return e}function n(e){this.options={container:"",woosmapKey:"",userAllowedReco:!1,omitUIReco:!1,withDistanceMatrix:!0,google:{},urls:{store:{href:!1,target:"_self"},stores:{href:"https://developers.woosmap.com/",target:"_self"}},usePlaces:!0,autocompletePlaces:{minLength:1,types:["geocode"]},useLocalities:!1,autocompleteLocalities:{url:"https://sdk.woosmap.com/localities/localities.js",componentRestrictions:{country:[]},types:"",language:"",data:"standard",minLength:3},geocoder:{region:"fr"},woosmap:{apiUrl:"https://api.woosmap.com/stores/search",recoScriptUrl:"https://sdk.woosmap.com/recommendation/recommendation.js",geolocApiUrl:"https://api.woosmap.com/geolocation/",query:"",limit:5,maxDistance:0},display:{recommendation:{address:!0,phone:!0,openingDay:!0,openingWeek:!0},search:{address:!0,openingDay:!0,openingWeek:!0}},lang:"fr",translations:{fr:{searchAroundMeBtn:"Autour de moi",searchAroundMeTitle:"Rechercher le centre à proximité",selectAroundMeTitle:"Choisissez le centre à proximité :",noResultsWarning:"Nous ne trouvons aucun résultat à proximité.",autocompletePlaceholder:"Spécifiez une adresse",allStores:"Tous nos centres",changeStore:"Centre à proximité",findStore:"Choisir mon centre",selectStore:"Choisir",openingHoursDay:"Ouvert aujourd'hui :",openingHoursWeek:"",geolocationNotice:"La géolocalisation n'est pas activée sur votre navigateur. Veuillez changez vos préférences.",geolocationErrHttps:"Votre position géographique n’a pas été renvoyée par votre navigateur. Veuillez saisir une adresse pour rechercher les magasins à proximité.",geolocationErrBlocked:"La géolocalisation n'est pas activée sur votre navigateur. Veuillez saisir une adresse pour rechercher les magasins à proximité.",telephone:"Tél :",closeBtn:"Fermer",closedHours:"Fermé",open24:"24h/24",days:{1:{full:"Lundi",short:"Lun"},2:{full:"Mardi",short:"Mar"},3:{full:"Mercredi",short:"Mer"},4:{full:"Jeudi",short:"Jeu"},5:{full:"Vendredi",short:"Ven"},6:{full:"Samedi",short:"Sam"},7:{full:"Dimanche",short:"Dim"}}},en:{searchAroundMeBtn:"Around Me",searchAroundMeTitle:"Search nearest Store",selectAroundMeTitle:"Choose nearest store from :",noResultsWarning:"Can't find nearby results.",autocompletePlaceholder:"Address...",allStores:"All Stores",changeStore:"Recommended Store",findStore:"Find my Store",geolocationNotice:"Geolocation capability is'nt enable on your browser. Please, change your settings.",closeBtn:"Close",selectStore:"Set as Favorite",telephone:"Tel:",open24:"All Day",openingHoursDay:"today: ",openingHoursWeek:"opening hours: ",closedHours:"Closed",days:{1:{full:"Monday",short:"Mon"},2:{full:"Tuesday",short:"Tue"},3:{full:"Wednesday",short:"Wed"},4:{full:"Thursday",short:"Thu"},5:{full:"Friday",short:"Fri"},6:{full:"Saturday",short:"Sat"},7:{full:"Sunday",short:"Sun"}}},es:{closedHours:"Cerrada"},ca:{closedHours:"Tancada"}}},this.L10n={},this.extend(e),this.initializeL10n()}var r=t(0);n.prototype.initializeL10n=function(){var e=(this.options.lang&&this.options.lang,this.options.lang);e&&(this.options.translations.hasOwnProperty(e)?this.L10n=this.options.translations[e]:(console.warn("translations lang '"+e+"' not found"),this.L10n=this.options.translations[r.defaultLang]))},n.prototype.extend=function(e){i(this.options,e),this.checkConfig(this.options)},n.prototype.checkConfig=function(e){if(void 0===e.container)throw new Error("the container (html locator) is undefined");if("string"!=typeof e.container)throw new Error("the container (html locator) must be a string");if(""===e.container.replace(" ",""))throw new Error("the container (html locator) is empty");if(void 0===e.woosmapKey)throw new Error("woosmapKey (public key) is undefined");if("string"!=typeof e.woosmapKey)throw new Error("woosmapKey (public key) must be a string");if(""===e.woosmapKey.replace(" ",""))throw new Error("woosmapKey (public key) is empty");if(void 0===e.google)throw new Error("google options is not defined");if("object"!=typeof e.google)throw new Error("google options must be an object");if(void 0===e.google.clientId&&void 0===e.google.key)throw new Error("google clientId or api key must be defined");if(void 0!==e.google.clientId){if("string"!=typeof e.google.clientId)throw new Error("google clientId must be a string");if(""===e.google.clientId.replace(" ",""))throw new Error("google clientId is empty");if(void 0!==e.google.channel&&"string"!=typeof e.google.channel)throw new Error("google client channel must be a string")}else if(void 0!==e.google.key){if("string"!=typeof e.google.key)throw new Error("google api key must be a string");if(""===e.google.key.replace(" ",""))throw new Error("google api key is empty")}if(void 0!==e.google.language){if("string"!=typeof e.google.language)throw new Error("google api language must be a string");if(2!==e.google.language.length)throw new Error("google api language format is not valid")}if(void 0!==e.google.region){if("string"!=typeof e.google.region)throw new Error("google api region must be a string");if(2!==e.google.language.length)throw new Error("google api region format is not valid")}if(void 0!==e.urls){if(void 0!==e.urls.stores){if("string"!=typeof e.urls.stores.href)throw new Error("urls.stores.href must be a string");if(void 0!==e.urls.stores.target){if("string"!=typeof e.urls.stores.target)throw new Error("urls.stores.target must be a string");if(-1===wgs.searchwidget.CONSTANT.target.indexOf(e.urls.stores.target))throw new Error("urls.stores.target must be : "+wgs.searchwidget.CONSTANT.target.join(", "))}}if(void 0!==e.urls.store){if(void 0!==e.urls.store.href&&"string"!=typeof e.urls.store.href&&"boolean"!=typeof e.urls.store.href)throw new Error("urls.stores.href must be a string or boolean");if(void 0!==e.urls.store.target){if("string"!=typeof e.urls.store.target)throw new Error("urls.store.target must be a string");if(-1===wgs.searchwidget.CONSTANT.target.indexOf(e.urls.store.target))throw new Error("urls.store.target must be : "+wgs.searchwidget.CONSTANT.target.join(", "))}}}if(void 0!==e.usePlaces&&"boolean"!=typeof e.usePlaces)throw new Error("usePlaces must be a boolean");if(void 0!==e.useLocalities&&"boolean"!=typeof e.useLocalities)throw new Error("useLocalities must be a boolean");if(void 0!==e.autocompletePlaces){if("number"!=typeof e.autocompletePlaces.minLength)throw new Error("autocompletePlaces.minLength must be a number");if(void 0!==e.autocompletePlaces.bounds){if("object"!=typeof e.autocompletePlaces.bounds)throw new Error("autocompletePlaces.bounds must be an object {west: <number>, north: <number>, south: <number>, east: <number>}");if(void 0===e.autocompletePlaces.bounds.west)throw new Error("autocompletePlaces.bounds.west is missing");if("number"!=typeof e.autocompletePlaces.bounds.west)throw new Error("autocompletePlaces.bounds.west must be a number");if(void 0===e.autocompletePlaces.bounds.north)throw new Error("autocompletePlaces.bounds.north is missing");if("number"!=typeof e.autocompletePlaces.bounds.north)throw new Error("autocompletePlaces.bounds.north must be a number");if(void 0===e.autocompletePlaces.bounds.south)throw new Error("autocompletePlaces.bounds.south is missing");if("number"!=typeof e.autocompletePlaces.bounds.south)throw new Error("autocompletePlaces.bounds.south must be a number");if(void 0===e.autocompletePlaces.bounds.east)throw new Error("autocompletePlaces.bounds.east is missing");if("number"!=typeof e.autocompletePlaces.bounds.east)throw new Error("autocompletePlaces.bounds.east must be a number")}if(void 0!==e.autocompletePlaces.types&&!Array.isArray(e.autocompletePlaces.types))throw new Error("autocompletePlaces.types must be an array of string, e.g: ['geocode']");if(void 0!==e.autocompletePlaces.componentRestrictions&&"object"!=typeof e.autocompletePlaces.componentRestrictions)throw new Error("autocompletePlaces.componentRestrictions must be a Google GeocoderComponentRestrictions object")}if(void 0!==e.display){if(void 0!==e.display.h12&&"boolean"!=typeof e.display.h12)throw new Error("display.h12 option (AM/PM) must be a boolean");if(void 0!==e.display.search){if("object"!=typeof e.display.search)throw new Error("display search option must be an object");if(void 0!==e.display.search.openingDay&&"boolean"!=typeof e.display.search.openingDay)throw new Error("display.search.openingDay option must be a boolean");if(void 0!==e.display.search.openingWeek&&"boolean"!=typeof e.display.search.openingWeek)throw new Error("display.search.openingWeek option must be a boolean");if(void 0!==e.display.search.address&&"boolean"!=typeof e.display.search.address)throw new Error("display.search.address option must be a boolean")}if(void 0!==e.display.recommendation){if("object"!=typeof e.display.recommendation)throw new Error("display.recommendation.option must be an object");if(void 0!==e.display.recommendation.openingDay&&"boolean"!=typeof e.display.recommendation.openingDay)throw new Error("display.recommendation.openingDay option must be a boolean");if(void 0!==e.display.recommendation.openingWeek&&"boolean"!=typeof e.display.recommendation.openingWeek)throw new Error("display.recommendation.openingWeek option must be a boolean");if(void 0!==e.display.recommendation.address&&"boolean"!=typeof e.display.recommendation.address)throw new Error("display.recommendation.address option must be a boolean");if(void 0!==e.display.recommendation.phone&&"boolean"!=typeof e.display.recommendation.phone)throw new Error("display.recommendation.phone option must be a boolean")}}if(void 0===e.lang)throw new Error("autocompletePlaces.lang is undefined, e.g: 'fr'");if("string"!=typeof e.lang)throw new Error("autocompletePlaces.lang must be a string");if(void 0===e.translations[e.lang])throw new Error("translations for the lang '"+e.lang+"' are not found");if("object"!=typeof e.translations[e.lang])throw new Error("translations must be an object");for(var o in e.translations[e.lang])if(e.translations[e.lang].hasOwnProperty(o))if("days"===o){if("object"!=typeof e.translations[e.lang][o])throw new Error("translations."+e.lang+"."+o+" must be an object (days list)")}else if("string"!=typeof e.translations[e.lang][o])throw new Error("translations."+e.lang+"."+o+" must be a string")},e.exports=n},function(e,o){function t(e,o){var t=document.createElement("script");t.type="text/javascript",t.async=!0,t.src=e;var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(t,s),t.readyState?t.onreadystatechange=function(){"complete"===this.readyState||"loaded"===this.readyState?o():console.error("Error when loading script "+e)}:(t.onload=function(){o()},t.onerror=function(){console.error("Error when loading script "+e)})}function s(e){this.clientId=e.clientId,this.apiKey=e.key,this.channel=e.channelId,this.librariesToLoad=e.librariesToLoad||[],this.language=e.language||"fr",this.region=e.region||void 0,this.version=e.version||"3"}s.prototype.load=function(e){var o="",s="https://maps.googleapis.com/maps/api/js?";this.language&&(o+="&language="+this.language),this.region&&(o+="&region="+this.region),this.clientId&&(o+="&client="+this.clientId),this.apiKey&&(o+="&key="+this.apiKey),this.channel&&(o+="&channel="+this.channel),this.librariesToLoad.length>0&&(o+="&libraries="+this.librariesToLoad.join(",")),s+=o,t(s,function(){e&&e()})},e.exports=s},function(e,o,t){function s(e,o,t){this.plugin=o,this.container=e,this.config=t;var s=this.config.L10n;this.container.innerHTML='<div class="gr-wgs-homestore-container"><div class="gr-wgs-homestore-mainBlock"></div><div id="gr-wgs-homestore-panel" class="'+(!0===this.config.options.omitUIReco?" omit-reco-ui":"")+'"><div class="gr-wgs-homestore-panel-searchBlock"><div class="gr-wgs-homestore-panel-searchBlock-warning">'+s.geolocationNotice+'</div></div><div class="gr-wgs-homestore-panel-loaderBlock"></div><div class="gr-wgs-homestore-panel-resultBlock"><div class="gr-wgs-homestore-panel-resultBlock-title">'+s.selectAroundMeTitle+'</div><ul class="gr-wgs-homestore-panel-resultBlock-listBlock"></ul></div><div class="gr-wgs-homestore-panel-footerBlock"><div class="gr-wgs-homestore-panel-footerBlock-allStores">'+(""!==this.config.options.urls.stores.href.replace(" ","")?s.allStores:"")+"</div>"+(!0===this.config.options.omitUIReco?"":'<div class="gr-wgs-homestore-panel-footerBlock-closePanel">'+s.closeBtn+"</div>")+"</div></div></div>",this.mainContainer=this.container.querySelector(".gr-wgs-homestore-container"),this.headerContainer=this.container.querySelector(".gr-wgs-homestore-mainBlock"),this.panelContainer=this.container.querySelector("#gr-wgs-homestore-panel"),this.panelContainerSearch=this.container.querySelector(".gr-wgs-homestore-panel-searchBlock"),this.panelContainerSearchWarning=this.container.querySelector(".gr-wgs-homestore-panel-searchBlock-warning"),this.panelContainerResultsBlock=this.container.querySelector(".gr-wgs-homestore-panel-resultBlock"),this.panelContainerResultsBlockTitle=this.container.querySelector(".gr-wgs-homestore-panel-resultBlock-title"),this.panelContainerResultsList=this.container.querySelector(".gr-wgs-homestore-panel-resultBlock-listBlock"),this.panelContainerFooter=this.container.querySelector(".gr-wgs-homestore-panel-footerBlock"),new i(this.panelContainerSearch,this.plugin,this.config),this.config.options.useLocalities?this._searchManager=new a(this.panelContainerSearch,this.plugin,this.config):this.config.options.usePlaces?this._searchManager=new n(this.panelContainerSearch,this.plugin,this.config):this._searchManager=new r(this.panelContainerSearch,this.plugin,this.config),this.hideResultsBlock(),this.hideWarningHTML5();var l=this;this.panelContainer.querySelector(".gr-wgs-homestore-panel-footerBlock-allStores").addEventListener("click",function(){l.openAllStores()}),!1===this.config.options.omitUIReco&&this.panelContainer.querySelector(".gr-wgs-homestore-panel-footerBlock-closePanel").addEventListener("click",function(){l.hideSearchPanel()}),this.onClickOutsideContainer()}var i=t(8),n=t(9),r=t(10),a=t(11);s.prototype.buildAddress=function(e){var o="",t="";if(e.properties.address.lines)for(var s=0;s<e.properties.address.lines.length;s++)""!==e.properties.address.lines[s]&&null!==e.properties.address.lines[s]&&(o+=" "+e.properties.address.lines[s]);return e.properties.address.zipcode&&""!==e.properties.address.zipcode&&(t+=e.properties.address.zipcode),e.properties.address.city&&""!==e.properties.address.city&&(t+=(""!==t?" ":"")+e.properties.address.city),o+=""!==o&&""!==t?'<span class="gr-wgs-homestore-mainBlock-yourStore-city">'+t:"</span>",e.properties.address.country_code&&""!==e.properties.address.country_code&&(o+='<span class="gr-wgs-homestore-mainBlock-yourStore-country"><span class="gr-wgs-homestore-mainBlock-yourStore-sep">, </span><span class="gr-wgs-homestore-mainBlock-yourStore-countrycode">'+e.properties.address.country_code+"</span></span>"),o},s.prototype.buildHTMLInitialReco=function(e){var o=this,t="",s="",i="",n="",r=e.properties.open,a=e.properties.opening_hours;void 0!==this.config.options.display.recommendation.address&&this.config.options.display.recommendation.address&&(t='<span class="gr-wgs-homestore-mainBlock-yourStore-address">'+this.buildAddress(e)+"</span>"),r&&void 0!==this.config.options.display.recommendation.openingDay&&this.config.options.display.recommendation.openingDay&&(i=this.buildHTMLOpeningHoursDay(e)),a&&void 0!==this.config.options.display.recommendation.openingWeek&&this.config.options.display.recommendation.openingWeek&&(n=this.buildHTMLOpeningHoursWeek(e)),void 0!==this.config.options.display.recommendation.phone&&this.config.options.display.recommendation.phone&&e.properties.contact&&""!==e.properties.contact.phone&&(s+='<span class="gr-wgs-homestore-mainBlock-yourStore-phone"><span class="gr-wgs-homestore-mainBlock-yourStore-phone-label">'+this.config.L10n.telephone+"</span> "+(e.properties.contact.phone?e.properties.contact.phone:"")+"</span>"),this.headerContainer.innerHTML='<div class="gr-wgs-homestore-mainBlockTitle gr-wgs-homestore-mainBlock-yourStore"><span class="gr-wgs-homestore-mainBlock-yourStore-icon"></span><span class="gr-wgs-homestore-mainBlock-yourStore-change">'+this.config.L10n.changeStore+'</span><span class="gr-wgs-homestore-mainBlock-yourStore-name">'+e.properties.name+"</span>"+t+s+'<span class="gr-wgs-homestore-mainBlock-yourStore-openinghours">'+i+n+"</span></div>",!1===o.config.options.omitUIReco&&this.headerContainer.querySelector(".gr-wgs-homestore-mainBlock-yourStore").addEventListener("click",function(){o.toggleSearchPanel()})},s.prototype.buildHTMLFindMyStore=function(e){var o=void 0!==e?e:this.config.L10n.findStore;this.headerContainer.innerHTML='<div class="gr-wgs-homestore-mainBlockTitle gr-wgs-homestore-mainBlock-findStore"><span class="gr-wgs-homestore-mainBlock-yourStore-icon"></span><span class="gr-wgs-homestore-mainBlock-yourStore-change">'+this.config.L10n.changeStore+'</span><span class="gr-wgs-homestore-mainBlock-yourStore-name">'+o+"</span></div>";var t=this;this.headerContainer.querySelector(".gr-wgs-homestore-mainBlock-findStore").addEventListener("click",function(){t.showSearchPanel()})},s.prototype.buildWarningHTML5=function(){this.container.insertAdjacentHTML("afterbegin",'<div class="gr-wgs-homestore-panel-searchBlock-warning"></div>')},s.prototype.onClickOutsideContainer=function(){window.addEventListener("click",function(e){!1===this.config.options.omitUIReco&&this.isVisibleSearchPanel()&&e.target.getAttribute("id")!==this.config.options.container.replace("#","")&&this.hideSearchPanel()}.bind(this)),this.mainContainer.addEventListener("click",function(e){return e.stopPropagation(),!1})},s.prototype.isVisibleSearchPanel=function(){return this.panelContainer.classList.contains("gr-wgs-homestore-panel-open")},s.prototype.showSearchPanel=function(){this.panelContainer.classList.add("gr-wgs-homestore-panel-open")},s.prototype.hideSearchPanel=function(){this.panelContainer.classList.remove("gr-wgs-homestore-panel-open")},s.prototype.toggleSearchPanel=function(){this.isVisibleSearchPanel()?this.hideSearchPanel():this.showSearchPanel()},s.prototype.showResultsBlock=function(){this.panelContainerResultsBlock.style.display="block"},s.prototype.hideResultsBlock=function(){this.panelContainerResultsBlock.style.display="none"},s.prototype.slideDownWarningHTML5=function(e){this.panelContainerSearchWarning.innerText=e,this.panelContainerSearchWarning.style.display="block"},s.prototype.slideUpWarningHTML5=function(){this.panelContainerSearchWarning.style.display="none"},s.prototype.hideWarningHTML5=function(){this.panelContainerSearchWarning.style.display="none"},s.prototype.buildHTMLRecommendationResults=function(e){this.panelContainerResultsList.innerHTML="",this.panelContainerResultsBlockTitle.innerHTML=this.config.L10n.selectAroundMeTitle;for(var o=0;o<e.length;o++)this.buildHTMLStore(e[o]);this.showResultsBlock()},s.prototype.buildHTMLNoResults=function(){this.panelContainerResultsList.innerHTML="",this.panelContainerResultsBlockTitle.innerHTML=this.config.L10n.noResultsWarning,this.showResultsBlock()},s.prototype.convertTo12Hrs=function(e,o){if(void 0===o&&(o=":"),void 0===e)return!1;if("string"!=typeof e)return!1;var t=e.split(o),s=parseInt(t[0]),i=s>12?"PM":"AM";return(s>12?s-12:s)+o+t[1]+" "+i},s.prototype.concatenateStoreHours=function(e){var o,t="";if(e){if(e["all-day"]||e.all_day)return this.config.L10n.open24?this.config.L10n.open24:"24h/24";for(var s in e)"object"==typeof e[s]&&(o=e[s].end,void 0!==this.config.options.display.h12&&this.config.options.display.h12?t+=this.convertTo12Hrs(e[s].start)+"–"+this.convertTo12Hrs(o):t+=e[s].start+"–"+o,s<e.length-1&&(t+=", "))}return t},s.prototype.getNextSixDays=function(e){for(var o=new Date,t=o.getDay(),s=e.properties.weekly_opening,i=e.properties.opening_hours,n={},r=!1;Object.keys(n).length<6;)if(0===o.getDay())for(;Object.keys(n).length<6;){if(o.setDate(o.getDate()+1),r=!1,i.special){var a=o.getUTCMonth()+1,l=o.getUTCDate(),c=o.getUTCFullYear(),p=c+"-"+a+"-"+l;p in i.special&&(r=!0,n[this.config.L10n.days[o.getDay()].full]=i.special[p])}if(!1===r)if(o.getDay()in i.usual)n[this.config.L10n.days[o.getDay()].full]=i.usual[o.getDay()];else{if(!i.default)break;n[this.config.L10n.days[o.getDay()].full]=i.default}}else{if(o.setDate(o.getDate()+1),t=0===o.getDay()?7:o.getDay(),!s)break;n[this.config.L10n.days[t].full]=s[t].hours}return n},s.prototype.generateHoursLiArray=function(e){var o=[],t=this.getNextSixDays(e);for(var s in t)0===t[s].length?o.push("<li>"+s+" : "+this.config.L10n.closedHours+"</li>"):o.push("<li>"+s+" : "+this.concatenateStoreHours(t[s])+"</li>");return o},s.prototype.buildHTMLOpeningHoursDay=function(e){var o="",t=e.properties.open;if(t.open_hours.length>0){o+='<span class="gr-wgs-openinghours-day">'+this.config.L10n.openingHoursDay+"</span>",o+='<ul class="gr-wgs-openinghours-day-'+t.week_day+(t.open_now?" gr-wgs-openinghours-opennow":"")+'">';for(var s=0;s<t.open_hours.length;s++)o+='<li class="gr-wgs-openinghours-day-slice">',void 0!==this.config.options.display.h12&&this.config.options.display.h12?o+=this.convertTo12Hrs(t.open_hours[s].start)+" - "+this.convertTo12Hrs(t.open_hours[s].end):o+=t.open_hours[s].start+" - "+t.open_hours[s].end,o+="</li>";o+="</ul>"}else!1===t.open_now&&(o+='<span class="gr-wgs-openinghours-day">'+this.config.L10n.openingHoursDay+"</span>",o+='<ul class="gr-wgs-openinghours-day-'+t.week_day+'">',o+='<li class="gr-wgs-openinghours-day-slice">',o+=this.config.L10n.closedHours,o+="</li>",o+="</ul>");return o},s.prototype.buildHTMLOpeningHoursWeek=function(e){var o="",t=e.properties.opening_hours;return(t.usual.default&&t.usual.default.length>0||Object.keys(t.usual).length>1)&&(o+='<span class="gr-wgs-openinghours-week-btn">'+this.config.L10n.openingHoursWeek+"</span>",o+='<ul class="gr-wgs-openinghours-week">'+this.generateHoursLiArray(e).join("")+"</ul>"),o},s.prototype.buildHTMLStore=function(e){var o="",t="",s="",i=e.properties.open,n=e.properties.opening_hours,r=e.properties.distanceWithGoogle/1e3;void 0!==this.config.options.display.search.address&&this.config.options.display.search.address&&(o='<div class="gr-wgs-homestore-panel-resultBlock-listItem-address">'+this.buildAddress(e)+"</div>"),i&&void 0!==this.config.options.display.search.openingDay&&this.config.options.display.search.openingDay&&(t=this.buildHTMLOpeningHoursDay(e)),n&&void 0!==this.config.options.display.search.openingWeek&&this.config.options.display.search.openingWeek&&(s=this.buildHTMLOpeningHoursWeek(e));var a='<li class="gr-wgs-homestore-panel-resultBlock-listItem" data-id="'+e.properties.store_id+'"><span class="gr-wgs-homestore-panel-resultBlock-listItem-icon"></span><span class="gr-wgs-homestore-panel-resultBlock-listItem-infos"><div><div class="gr-wgs-homestore-panel-resultBlock-listItem-title">'+e.properties.name+'</div><div class="gr-wgs-homestore-panel-resultBlock-listItem-choose">'+this.config.L10n.selectStore+'</div><div class="gr-wgs-homestore-panel-resultBlock-listItem-distance">'+(isNaN(r)?"":"("+r.toFixed(1)+"km)")+"</div>"+o+'<div class="gr-wgs-homestore-panel-resultBlock-listItem-openinghours">'+t+s+"</div></div></span></li>";this.panelContainerResultsList.insertAdjacentHTML("beforeend",a),this.panelContainerResultsList.querySelector('.gr-wgs-homestore-panel-resultBlock-listItem[data-id="'+e.properties.store_id+'"]').addEventListener("click",function(){var o=e.geometry.coordinates,t=o[1],s=o[0];this.plugin.ui.resetStoreSearch(),!1===this.config.options.omitUIReco&&(this.hideSearchPanel(),this.plugin.ui.buildHTMLInitialReco(e)),this.plugin.callbackUserSelectedStore instanceof Function&&this.plugin.callbackUserSelectedStore(e),this.plugin.manager.saveStoreToLocalStorage(e),!0===this.config.options.userAllowedReco&&woosmapRecommendation.sendUserFavoritedPOI({lat:t,lng:s,id:e.properties.store_id,successCallback:function(){}.bind(this),errorCallback:function(){console.warn("Error Sending Favorited POI to Woosmap!",t,s,e.properties.store_id)}.bind(this)})}.bind(this))},s.prototype.resetStoreSearch=function(){this._searchManager.clearPanel()},s.prototype.openStore=function(e){var o;e.properties.contact&&e.properties.contact.website&&!1!==this.config.options.urls.store.target&&(!0===this.config.options.urls.store.href?o=e.properties.contact.website:"string"==typeof this.config.options.urls.store.href&&(o=this.config.options.urls.store.href),window.open(o,this.config.options.urls.store.target||"_self"))},s.prototype.openAllStores=function(){window.open(this.config.options.urls.stores.href,this.config.options.urls.stores.target||"_self")},s.prototype.hideResetBtn=function(){this.panelContainer.querySelector(".gr-wgs-homestore-panel-address-reset").style.display="none"},s.prototype.showResetBtn=function(){this.panelContainer.querySelector(".gr-wgs-homestore-panel-address-reset").style.display="block"},s.prototype.showLoader=function(){this.panelContainer.querySelector(".gr-wgs-homestore-panel-address-reset").style.display="none",this.panelContainer.querySelector(".gr-wgs-homestore-panel-address-loader").style.display="block"},s.prototype.hideLoader=function(){this.panelContainer.querySelector(".gr-wgs-homestore-panel-address-reset").style.display="block",this.panelContainer.querySelector(".gr-wgs-homestore-panel-address-loader").style.display="none"},e.exports=s},function(e,o){function t(e,o,t){this.config=t,this.container=e,this.plugin=o,this.ERRORS={HTTPS:void 0!==this.config.L10n.geolocationErrHttps?this.config.L10n.geolocationErrHttps:"...Geolocation works only through HTTPS",BLOCKED:void 0!==this.config.L10n.geolocationErrBlocked?this.config.L10n.geolocationErrBlocked:"...Geolocation Blocked By User"},this.initialize()}t.prototype.initialize=function(){this.buildHTML(),this.defineEvents()},t.prototype.buildHTML=function(){var e='<div class="gr-wgs-homestore-panel-searchBlock-btn gr-wgs-homestore-panel-aroundMe-btn">'+this.config.L10n.searchAroundMeBtn+"</div>";this.container.insertAdjacentHTML("afterbegin",e)},t.prototype.defineEvents=function(){var e=this,o=function(o){var t=o.coords.latitude,s=o.coords.longitude;e.plugin.manager.recommendStoresFromHTML5(t,s),e.plugin.callbackOnSuccessHTML5Location instanceof Function&&e.plugin.callbackOnSuccessHTML5Location(o)},t=function(o){o&&o.message&&0===o.message.indexOf("Only secure origins are allowed")?e.plugin.ui.slideDownWarningHTML5(e.ERRORS.HTTPS):e.plugin.ui.slideDownWarningHTML5(e.ERRORS.BLOCKED),e.plugin.callbackOnErrorHTML5Location instanceof Function&&e.plugin.callbackOnErrorHTML5Location(o)};this.container.querySelector(".gr-wgs-homestore-panel-aroundMe-btn").addEventListener("click",function(){navigator.geolocation.getCurrentPosition(o,t)})},e.exports=t},function(e,o){function t(e,o,t){this.config=t,this.plugin=o,this.container=e,this.containerPredictionsList=null,this.buildHTML()}t.prototype.buildHTML=function(){var e='<div class="gr-wgs-homestore-panel-address-wrapper"><label>'+this.config.L10n.searchAroundMeTitle+'</label><div class="gr-wgs-homestore-panel-searchBlock-form"><input class="gr-wgs-homestore-panel-address-input" type="text" placeholder="'+this.config.L10n.autocompletePlaceholder+'"/></div><div class="gr-wgs-homestore-panel-address-reset"></div><div class="gr-wgs-homestore-panel-address-loader"></div></div><div class= "gr-wgs-homestore-panel-address-predictions gr-wgs-pac-container"></div>';this.container.insertAdjacentHTML("beforeend",e),this.containerPredictionsList=this.container.querySelector(".gr-wgs-homestore-panel-address-predictions");var o=this;this.container.querySelector("input").addEventListener("keyup",function(e){var t="gr-wgs-pac-item-selected",s=o.containerPredictionsList.querySelector(".gr-wgs-pac-item-selected"),i=o.containerPredictionsList.querySelector(".gr-wgs-pac-item"),n=o.containerPredictionsList.querySelector(".gr-wgs-pac-item:last-child");if(13===e.keyCode){var r=document.createEvent("MouseEvents");r.initEvent("click",!0,!0),null!==s?s.dispatchEvent(r):null!==i&&i.dispatchEvent(r)}else if(38===e.keyCode)if(s){var a=s.previousElementSibling;s.classList.remove(t),null===a?n.classList.add(t):a.classList.add(t)}else null!==n&&n.classList.add(t);else if(40===e.keyCode)if(s){var l=s.nextElementSibling;s.classList.remove(t),null===l?i.classList.add(t):l.classList.add(t)}else null!==i&&i.classList.add(t);else if(e.currentTarget.value.length>=this.config.options.autocompletePlaces.minLength){var c={input:o.container.querySelector("input").value};this.config.options.autocompletePlaces.bounds&&(c.bounds=this.config.options.autocompletePlaces.bounds),this.config.options.autocompletePlaces.types&&(c.types=this.config.options.autocompletePlaces.types),this.config.options.autocompletePlaces.componentRestrictions&&(c.componentRestrictions=this.config.options.autocompletePlaces.componentRestrictions),o.getPredictions(c,function(e){o.buildHTMLPredictions(e)},function(e){console.error(e)})}0===e.currentTarget.value.length?o.clearPanel():o.plugin.ui.showResetBtn()}.bind(this)),o.containerPredictionsList.addEventListener("click",function(e){var t=e.target.closest(".gr-wgs-pac-item"),s=t.getAttribute("data-place-id");o.container.querySelector("input").value=t.querySelector(".gr-wgs-pac-item-query").innerText,o.containerPredictionsList.style.display="none",o.getDetails(s)},!0),this.container.querySelector(".gr-wgs-homestore-panel-address-reset").addEventListener("click",function(){o.clearPanel()})},t.prototype.clearPanel=function(){this.container.querySelector("input").value="",this.containerPredictionsList.innerHTML="",this.containerPredictionsList.style.display="none",this.plugin.ui.hideResultsBlock(),this.plugin.ui.hideResetBtn()},t.prototype.buildHTMLPredictions=function(e){var o=this;this.containerPredictionsList.innerHTML="",this.containerPredictionsList.style.display=e.length>0?"block":"none";for(var t=0;t<e.length;t++)!function(e){var t='<div class="gr-wgs-pac-item" data-place-id="'+e.place_id+'"><span class="gr-wgs-pac-icon gr-wgs-pac-icon-marker"></span><span class="gr-wgs-pac-item-query">'+e.description+"</span></div>";o.containerPredictionsList.insertAdjacentHTML("beforeend",t)}(e[t])},t.prototype.getPredictions=function(e){var o=this;(new google.maps.places.AutocompleteService).getPlacePredictions(e,function(t,s){s===google.maps.places.PlacesServiceStatus.OK?o.buildHTMLPredictions(t):s===google.maps.places.PlacesServiceStatus.UNKNOWN_ERROR||s===google.maps.places.PlacesServiceStatus.OVER_QUERY_LIMIT?window.setTimeout(function(){o.getPredictions(e)},100):s===google.maps.places.PlacesServiceStatus.ZERO_RESULTS?o.buildHTMLPredictions([]):console.error(s)})},t.prototype.getDetails=function(e){var o=new google.maps.places.PlacesService(document.getElementsByClassName("gr-wgs-homestore-panel-address-input")[0]),t=this,s={placeId:e};o.getDetails(s,function(o,s){if(s===google.maps.places.PlacesServiceStatus.OK){var i=o.geometry.location.lat(),n=o.geometry.location.lng();t.plugin.manager.recommendStoresFromSearch(i,n)}else s===google.maps.places.PlacesServiceStatus.UNKNOWN_ERROR||s===google.maps.places.PlacesServiceStatus.OVER_QUERY_LIMIT?window.setTimeout(function(){t.getDetails(e)},100):console.error(s)})},e.exports=t},function(e,o){function t(e,o,t){this.config=t,this.plugin=o,this.container=e,this.containerResultsList=null,this.buildHTML()}t.prototype.buildHTML=function(){var e='<div class="gr-wgs-homestore-panel-address-wrapper"><label>'+this.config.L10n.searchAroundMeTitle+'</label><div class="gr-wgs-homestore-panel-searchBlock-form"><input class="gr-wgs-homestore-panel-address-input" type="text" placeholder="'+this.config.L10n.autocompletePlaceholder+'"/></div><div class="gr-wgs-homestore-panel-address-reset"></div><div class="gr-wgs-homestore-panel-address-loader"></div></div><div class= "gr-wgs-homestore-panel-address-results gr-wgs-pac-container"></div>';this.container.insertAdjacentHTML("beforeend",e),this.containerResultsList=this.container.querySelector(".gr-wgs-homestore-panel-address-results");var o=this;this.container.querySelector("input").addEventListener("keyup",function(e){var t="gr-wgs-pac-item-selected",s=o.containerResultsList.querySelector(".gr-wgs-pac-item-selected"),i=o.containerResultsList.querySelector(".gr-wgs-pac-item"),n=o.containerResultsList.querySelector(".gr-wgs-pac-item:last-child");if(13===e.keyCode){var r=document.createEvent("MouseEvents");if(r.initEvent("click",!0,!0),null!==s)s.dispatchEvent(r);else if(e.currentTarget.value.length>=1){var a=this.config.options.geocoder?this.config.options.geocoder:{};a.address=e.target.value,o.geocode(a)}}else if(38===e.keyCode)if(s){var l=s.previousElementSibling;s.classList.remove(t),null===l?n.classList.add(t):l.classList.add(t)}else null!==n&&n.classList.add(t);else if(40===e.keyCode)if(s){var c=s.nextElementSibling;s.classList.remove(t),null===c?i.classList.add(t):c.classList.add(t)}else null!==i&&i.classList.add(t);0===e.currentTarget.value.length?o.clearPanel():o.plugin.ui.showResetBtn()}.bind(this)),o.containerResultsList.addEventListener("click",function(e){var t=e.target,s=t.closest(".gr-wgs-pac-item"),i=s.getAttribute("data-lat"),n=s.getAttribute("data-lng");o.container.querySelector("input").value=s.querySelector(".gr-wgs-pac-item-query").innerText,o.askForStoresRecommendation(i,n),o.containerResultsList.style.display="none",o.containerResultsList.innerHTML=""},!0),o.container.querySelector(".gr-wgs-homestore-panel-address-reset").addEventListener("click",function(){o.clearPanel()})},t.prototype.clearPanel=function(){this.container.querySelector("input").value="",this.containerResultsList.style.display="none",this.containerResultsList.innerHTML="",this.plugin.ui.hideResultsBlock(),this.plugin.ui.hideResetBtn()},t.prototype.buildHTMLResults=function(e){var o=this;this.containerResultsList.innerHTML="",this.containerResultsList.style.display=e.length>0?"block":"none";for(var t=0;t<e.length;t++)!function(e){var t=e.geometry.location,s='<div class="gr-wgs-pac-item" data-lat="'+t.lat()+'" data-lng="'+t.lng()+'"><span class="gr-wgs-pac-icon gr-wgs-pac-icon-marker"></span><span class="gr-wgs-pac-item-query">'+e.formatted_address+"</span></div>";o.containerResultsList.insertAdjacentHTML("beforeend",s)}(e[t])},t.prototype.askForStoresRecommendation=function(e,o){this.plugin.manager.recommendStoresFromSearch(e,o)},t.prototype.geocode=function(e){var o=new google.maps.Geocoder,t=this;o.geocode(e,function(o,s){if(s===google.maps.GeocoderStatus.UNKNOWN_ERROR)t.geocode(e);else if(s===google.maps.GeocoderStatus.OK)if(1===o.length){t.container.querySelector(".gr-wgs-homestore-panel-address-input").value=o[0].formatted_address;var i=o[0].geometry.location;t.askForStoresRecommendation(i.lat(),i.lng()),t.buildHTMLResults([])}else t.buildHTMLResults(o);else s===google.maps.GeocoderStatus.ZERO_RESULTS?t.buildHTMLResults([]):console.error(s)})},e.exports=t},function(e,o){function t(e,o,t){this.config=t,this.plugin=o,this.container=e,this.containerResultsList=null,this.localitiesService=null,this.buildHTML(),this.getScript(t.options.autocompleteLocalities.url,function(){this.localitiesService=new window.woosmap.localities.AutocompleteService(t.options.woosmapKey)}.bind(this))}t.prototype.getScript=function(e,o){var t=document.createElement("script");t.type="text/javascript",t.async=!0,t.src=e;var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(t,s),t.readyState?t.onreadystatechange=function(){"complete"!==this.readyState&&"loaded"!==this.readyState||o()}:t.onload=function(){o()}},t.prototype.buildHTML=function(){var e='<div class="gr-wgs-homestore-panel-address-wrapper"><label>'+this.config.L10n.searchAroundMeTitle+'</label><div class="gr-wgs-homestore-panel-searchBlock-form"><input class="gr-wgs-homestore-panel-address-input" type="text" placeholder="'+this.config.L10n.autocompletePlaceholder+'"/></div><div class="gr-wgs-homestore-panel-address-reset"></div><div class="gr-wgs-homestore-panel-address-loader"></div></div><div class= "gr-wgs-homestore-panel-address-results gr-wgs-pac-container localities"></div>';this.container.insertAdjacentHTML("beforeend",e),this.containerResultsList=this.container.querySelector(".gr-wgs-homestore-panel-address-results");var o=this;this.container.querySelector("input").addEventListener("keyup",function(e){if(37!==e.keyCode&&39!==e.keyCode){var t="gr-wgs-pac-item-selected",s=o.containerResultsList.querySelector(".gr-wgs-pac-item-selected"),i=o.containerResultsList.querySelector(".gr-wgs-pac-item"),n=o.containerResultsList.querySelector(".gr-wgs-pac-item:last-child");if(13===e.keyCode){var r=document.createEvent("MouseEvents");r.initEvent("click",!0,!0),null!==s?s.dispatchEvent(r):null!==i&&i.dispatchEvent(r)}else if(38===e.keyCode)if(s){var a=s.previousElementSibling;s.classList.remove(t),null===a?n.classList.add(t):a.classList.add(t)}else null!==n&&n.classList.add(t);else if(40===e.keyCode)if(s){var l=s.nextElementSibling;s.classList.remove(t),null===l?i.classList.add(t):l.classList.add(t)}else null!==i&&i.classList.add(t);else e.currentTarget.value.length>=1&&o.getQueryPredictions(e.target.value);0===e.currentTarget.value.length?o.clearPanel():o.plugin.ui.showResetBtn()}}.bind(this)),o.containerResultsList.addEventListener("click",function(e){var t=e.target,s=t.closest(".gr-wgs-pac-item"),i=s.getAttribute("data-lat"),n=s.getAttribute("data-lng");o.container.querySelector("input").value=s.querySelector(".gr-wgs-pac-item-query").innerText,o.askForStoresRecommendation(i,n),o.containerResultsList.style.display="none",o.containerResultsList.innerHTML=""},!0),o.container.querySelector(".gr-wgs-homestore-panel-address-reset").addEventListener("click",function(){o.clearPanel()})},t.prototype.clearPanel=function(){this.container.querySelector("input").value="",this.containerResultsList.style.display="none",this.containerResultsList.innerHTML="",this.plugin.ui.hideResultsBlock(),this.plugin.ui.hideResetBtn()},t.prototype.buildHTMLResults=function(e){var o=this;this.containerResultsList.innerHTML="",this.containerResultsList.style.display=e.length>0?"block":"none";for(var t=0;t<e.length;t++)!function(e){var t=e.location,s='<div class="gr-wgs-pac-item" data-lat="'+t.lat+'" data-lng="'+t.lng+'"><span class="gr-wgs-pac-icon gr-wgs-pac-icon-marker"></span><span class="gr-wgs-pac-item-query">'+e.description+"</span></div>";o.containerResultsList.insertAdjacentHTML("beforeend",s)}(e[t])},t.prototype.askForStoresRecommendation=function(e,o){this.plugin.manager.recommendStoresFromSearch(e,o)},t.prototype.getQueryPredictions=function(e){var o={input:e,components:this.config.options.autocompleteLocalities.componentRestrictions,types:this.config.options.autocompleteLocalities.types,language:this.config.options.autocompleteLocalities.language,data:this.config.options.autocompleteLocalities.data};if(e.length>=this.config.options.autocompleteLocalities.minLength){var t=function(e){if(1===e.localities.length){this.container.querySelector(".gr-wgs-homestore-panel-address-input").value=e.localities[0].description;var o=e.localities[0].location;this.askForStoresRecommendation(o.lat,o.lng),this.buildHTMLResults([])}else this.buildHTMLResults(e.localities)};this.localitiesService.getQueryPredictions(o,t.bind(this))}},e.exports=t},function(e,o,t){function s(e,o){this.plugin=e,this.config=o,this.limit=this.config.options.woosmap.limit,this.query=this.config.options.woosmap.query,this.maxDistance=this.config.options.woosmap.maxDistance||0,this.searchAPIUrl=this.config.options.woosmap.apiUrl+"?key="+this.config.options.woosmapKey,!1===this.config.options.userAllowedReco&&(!0===this.config.options.omitUIReco?this.plugin.ui.showSearchPanel():this.plugin.ui.buildHTMLFindMyStore())}var i=t(13),n=t(1);s.prototype.getStoreFromLocalStorage=function(){return JSON.parse(window.localStorage.getItem(this.config.options.woosmapKey))},s.prototype.getStoreFromSessionStorage=function(){return JSON.parse(window.sessionStorage.getItem(this.config.options.woosmapKey))},s.prototype.saveStoreToLocalStorage=function(e){void 0!==window.localStorage&&window.localStorage.setItem(this.config.options.woosmapKey,JSON.stringify(e))},s.prototype.saveStoreToSessionStorage=function(e){void 0!==window.sessionStorage&&window.sessionStorage.setItem(this.config.options.woosmapKey,JSON.stringify(e))},s.prototype.initialRecommendation=function(){if(void 0!==window.sessionStorage&&void 0!==window.localStorage){var e=this.getStoreFromLocalStorage(),o=this.getStoreFromSessionStorage();null!==e?(!0===this.config.options.omitUIReco?this.plugin.ui.showSearchPanel():this.plugin.ui.buildHTMLInitialReco(e),this.plugin.callbackInitialRecommendedStore instanceof Function&&this.plugin.callbackInitialRecommendedStore(e)):null!==o?(!0===this.config.options.omitUIReco?this.plugin.ui.showSearchPanel():0===Object.keys(o).length?this.plugin.ui.buildHTMLFindMyStore():this.plugin.ui.buildHTMLInitialReco(o),this.plugin.callbackInitialRecommendedStore instanceof Function&&0!==Object.keys(o).length&&this.plugin.callbackInitialRecommendedStore(o)):!0===this.config.options.userAllowedReco&&this.getUserRecommendation()}else!0===this.config.options.userAllowedReco&&this.getUserRecommendation()},s.prototype.getUserRecommendation=function(){var e=this;woosmapRecommendation.getUserRecommendation({successCallback:function(o){if(o&&o.features&&o.features.length>0){var t=o.features;!0===e.config.options.omitUIReco?e.plugin.ui.showSearchPanel():e.plugin.ui.buildHTMLInitialReco(t[0]),e.saveStoreToSessionStorage(t[0]),e.plugin.callbackInitialRecommendedStore instanceof Function&&e.plugin.callbackInitialRecommendedStore(t[0])}else e.saveStoreToSessionStorage({}),!0===e.config.options.omitUIReco?e.plugin.ui.showSearchPanel():e.plugin.ui.buildHTMLFindMyStore()},errorCallback:function(o){401===o.status?e.plugin.ui.buildHTMLFindMyStore("...error, wrong public key"):403===o.status?e.plugin.ui.buildHTMLFindMyStore("...error, unauthorized domain"):e.plugin.ui.buildHTMLFindMyStore("...error retrieving data")},limit:this.limit,query:this.query,maxDistance:this.maxDistance})},s.prototype.searchStores=function(e,o){this.plugin.ui.showLoader();var t=this,s=function(){t.plugin.ui.hideLoader(),console.warn("Error Searching for Stores nearby!",e,o),t.plugin.ui.buildHTMLNoResults()};woosmapRecommendation.searchStores({lat:e,lng:o,successCallback:function(n){var r=n.features;r.length>0?i(r,e,o,function(e){t.plugin.ui.hideLoader(),t.plugin.ui.buildHTMLRecommendationResults(e)},s,this.config.options.withDistanceMatrix):(t.plugin.ui.hideLoader(),t.plugin.ui.buildHTMLNoResults())}.bind(this),errorCallback:s,storesByPage:this.limit,query:this.query,maxDistance:this.maxDistance})},s.prototype.searchStoresWithoutReco=function(e,o){this.plugin.ui.showLoader();var t=this,s=function(){t.plugin.ui.hideLoader(),console.warn("Can't find Stores nearby:",e,o),t.plugin.ui.buildHTMLNoResults()};n.get(this.searchAPIUrl+"&lat="+e+"&lng="+o+"&max_distance="+this.config.options.woosmap.maxDistance+"&stores_by_page="+this.limit+"&query="+this.config.options.woosmap.query,function(n){var r=JSON.parse(n),a=r.features;a.length>0?i(a,e,o,function(e){t.plugin.ui.hideLoader(),t.plugin.ui.buildHTMLRecommendationResults(e)},s,this.config.options.withDistanceMatrix):(t.plugin.ui.hideLoader(),t.plugin.ui.buildHTMLNoResults())}.bind(this),function(e){console.error("Error while searching stores ("+e+")"),s()})},s.prototype.selectStoreFromStoreId=function(e,o,t){n.get(this.searchAPIUrl+'&query=idstore:="'+e+'"',function(s){var i=JSON.parse(s),n=i.features;n.length>0?(this.saveStoreToLocalStorage(n[0]),this.plugin.ui.buildHTMLInitialReco(n[0]),void 0!==o&&o(n[0])):(void 0!==t&&t("No Store with ID: "+e),console.warn("No Store with ID:",e))}.bind(this),function(e){void 0!==t?t(e):console.error("Error while setting Selected store by Id ("+e+")")})},s.prototype.recommendStoresFromHTML5=function(e,o){!0===this.config.options.userAllowedReco?(this.searchStores(e,o),woosmapRecommendation.sendUserHtml5Position({lat:e,lng:o})):this.searchStoresWithoutReco(e,o)},s.prototype.recommendStoresFromSearch=function(e,o){!0===this.config.options.userAllowedReco?(this.searchStores(e,o),woosmapRecommendation.sendUserSearchedPosition({lat:e,lng:o})):this.searchStoresWithoutReco(e,o)},e.exports=s},function(e,o){function t(e,o){return void 0===e.properties.distanceWithGoogle||void 0===o.properties.distanceWithGoogle?null:e.properties.distanceWithGoogle-o.properties.distanceWithGoogle}function s(e,o,s,i,n,r){(new google.maps.DistanceMatrixService).getDistanceMatrix(e,function(a,l){if(l===google.maps.DistanceMatrixStatus.OK){for(var c=a.rows[0].elements,p=0,u=o.length;p<u;p++)c[p].status!==google.maps.DistanceMatrixElementStatus.ZERO_RESULTS&&(o[p].properties.distanceWithGoogle=c[p].distance.value);o.sort(t),n(o)}else l===google.maps.DistanceMatrixStatus.UNKNOWN_ERROR?window.setTimeout(function(){this.updateStores(e,o,s,i,n,r)}.bind(this),1500):(r(),console.error(l))})}function i(e,o,t,i,n,r){if(void 0!==r&&null!==r&&r){s({destinations:e.map(function(e){return new google.maps.LatLng(e.geometry.coordinates[1],e.geometry.coordinates[0])}),origins:[new google.maps.LatLng(o,t)],travelMode:google.maps.TravelMode.DRIVING},e,o,t,i,n)}else i(e)}e.exports=i},function(e,o,t){var s=t(1),i=function(e){this.geolocApiUrl=e.geolocApiUrl,this.searchApiUrl=e.apiUrl};i.prototype.setProjectKey=function(e){this.projectKey=e},i.prototype.optIn=function(){},i.prototype.optOut=function(){},i.prototype.sendUserHtml5Position=function(){},i.prototype.sendUserSearchedPosition=function(){},i.prototype.sendUserConsultedPOI=function(){},i.prototype.sendUserFavoritedPOI=function(){},i.prototype.getUserRecommendation=function(e){s.get(this.geolocApiUrl+"stores/?key="+this.projectKey+"&query="+e.query,function(o){var t={};"stores"in JSON.parse(o)&&(t=JSON.parse(o).stores),e.successCallback(t)},function(o){console.error("Error while getting user recommended stores ("+o+")"),e.errorCallback({})})},i.prototype.searchStores=function(e){s.get(this.searchApiUrl+"?key="+this.projectKey+"&lat="+e.lat+"&lng="+e.lng+"&max_distance="+e.maxDistance+"&stores_by_page="+e.storesByPage+"&query="+e.query,function(o){e.successCallback(JSON.parse(o))},function(o){console.error("Error while searching stores ("+o+")"),e.errorCallback()})},i.prototype.getConsent=function(e){e(!0)},e.exports=i}]);